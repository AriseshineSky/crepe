<%- contentFor('pageSection') %>
<style>
  .select,
  #locale {
    width: 100%;
  }
  .like {
    margin-right: 10px;
  }
  td,th {
    max-width: 3em;
  }
</style>

<div class="card text-center">
  <div class="card-header">
    <h4>产品列表</h4>
  </div>
  <div class="card-body">
    
    <table
      data-toggle="table"
      data-pagination="true"
      data-search="true"
      class="table table-hover"
    >
      <thead>
        <tr>
          <th>ASIN</th>
          <th>货期</th>
          <th>需要空派</th>
          <th>需要慢船</th>
          <th>设置平均销量</th>
          <th>预估最大销量</th>
          <th>亚马逊近7天平均销量</th>
          <th>每箱数量</th>
          <th>箱规</th>
          <th>plwhsId</th>
          <th>yisucangId</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% products.forEach(function(product) { %>
          <tr>
            <td><%= product.asin %></td>
            <td><%= product.cycle %></td>
            <td>
              <% if (product.airDelivery) { %>
                需要
              <% } else { %>
                不需要
              <% } %>
            </td>
            <td>
              <% if (product.sea) { %>
                需要
              <% } else { %>
                不需要
              <% } %>
            </td>
            <td><%= product.avgSales %></td>
            <td><%= product.maxAvgSales %></td>
            <td><%= product.ps %></td>
            <td><%= product.unitsPerBox %></td>
            <td><%= product.box.length %>*<%= product.box.width %>*<%= product.box.height %>cm</td>
            <td><%= product.plwhsId %></td>
            <td><%= product.yisucangId %></td>
            <td>
              <a href="/products/<%= product.asin %>/edit" target="_blank" type="button" class="btn btn-primary">Edit</a>
              <a href="/products/<%= product.asin %>/inbounds" target="_blank" type="button" class="btn btn-primary">Inbound</a>
              
              
              <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#myModal" data-product-id="<%=product._id%>" >Delete</button>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
      <a id="add" class="btn btn-primary" href="/products/new">
        Add New Product
      </a>
  </div>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
      <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title" id="myModalLabel">Are you sure to delete this product?</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-danger">Delete</button>
          </div>
      </div>
  </div>
</div>


<style>
  body {
    font-family: 'Varela Round', sans-serif;
  }
  .modal-confirm {		
    color: #636363;
    width: 400px;
  }
  .modal-confirm .modal-content {
    padding: 20px;
    border-radius: 5px;
    border: none;
    text-align: center;
    font-size: 14px;
  }
  .modal-confirm .modal-header {
    border-bottom: none;   
    position: relative;
  }
  .modal-confirm h4 {
    text-align: center;
    font-size: 26px;
    margin: 30px 0 -10px;
  }
  .modal-confirm .close {
    position: absolute;
    top: -5px;
    right: -2px;
  }
  .modal-confirm .modal-body {
    color: #999;
  }
  .modal-confirm .modal-footer {
    border: none;
    text-align: center;		
    border-radius: 5px;
    font-size: 13px;
    padding: 10px 15px 25px;
  }
  .modal-confirm .modal-footer a {
    color: #999;
  }		
  .modal-confirm .icon-box {
    width: 80px;
    height: 80px;
    margin: 0 auto;
    border-radius: 50%;
    z-index: 9;
    text-align: center;
    border: 3px solid #f15e5e;
  }
  .modal-confirm .icon-box i {
    color: #f15e5e;
    font-size: 46px;
    display: inline-block;
    margin-top: 13px;
  }
  .modal-confirm .btn, .modal-confirm .btn:active {
    color: #fff;
    border-radius: 4px;
    background: #60c7c1;
    text-decoration: none;
    transition: all 0.4s;
    line-height: normal;
    min-width: 120px;
    border: none;
    min-height: 40px;
    border-radius: 3px;
    margin: 0 5px;
  }
  .modal-confirm .btn-secondary {
    background: #c1c1c1;
  }
  .modal-confirm .btn-secondary:hover, .modal-confirm .btn-secondary:focus {
    background: #a8a8a8;
  }
  .modal-confirm .btn-danger {
    background: #f15e5e;
  }
  .modal-confirm .btn-danger:hover, .modal-confirm .btn-danger:focus {
    background: #ee3535;
  }
  .trigger-btn {
    display: inline-block;
    margin: 100px auto;
  }
  </style>
<script>
  $(document).ready(function() {
    $(".btn[data-bs-target='#myModal']").click(function() {
      console.log(1)
      var modalBody = $('<div id="myModal"></div>');
      var productId = $(this).data('product-id');
      var modalForm = $(`<div class="modal-dialog modal-confirm"> \
                          <div class="modal-content">\
                            <div class="modal-header flex-column">\
                              <h4 class="modal-title w-100">Are you sure?</h4>\
                            </div>\
                            <div class="modal-body">\
                              <p>Do you really want to delete this product? This process cannot be undone.</p>\
                            </div>\
                            <form role="form" name="modalForm" id="delete_product" action="/products/delete" method="post"> \
                              <div class="modal-footer justify-content-center"> \
                                <input class="form-control" name="productId" value="${productId}" type="hidden" > \
                              </div> \
                            </form>\
	                        </div>\
                        </div>`);
      modalBody.append(modalForm);
      $('.modal-body').html(modalBody);
    });
    $('.modal-footer .btn-danger').click(function() {
      $('form[name="modalForm"]').submit();
    });
  });
</script>